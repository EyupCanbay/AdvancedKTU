# Render.com Environment Variables Örneği
# Render Dashboard → Service → Environment sekmesinde bu variables'ları gir

# ============================================================================
# 1. AUTHENTICATION SERVICE (advancedktu-auth)
# ============================================================================

PORT=8080
DB_NAME=auth_db
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/auth_db
JWT_SECRET=your-super-secret-jwt-key-min-32-characters-long-here!
ENVIRONMENT=production

# ============================================================================
# 2. WASTE SERVICE (advancedktu-waste)
# ============================================================================

PORT=8081
DB_NAME=waste_db
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/waste_db
AUTH_SERVICE_URL=https://advancedktu-auth.onrender.com
AI_SERVICE_URL=https://advancedktu-ai.onrender.com
ENVIRONMENT=production

# ============================================================================
# 3. AI SERVICE (advancedktu-ai)
# ============================================================================

PORT=3000
NODE_ENV=production
GOOGLE_GENERATIVE_AI_API_KEY=AIzaSy...your-api-key-here...
LOG_LEVEL=info

# ============================================================================
# 4. FRONTEND (advancedktu-frontend)
# ============================================================================

VITE_API_BASE_URL=https://advancedktu-waste.onrender.com
VITE_AUTH_API_URL=https://advancedktu-auth.onrender.com
VITE_AI_API_URL=https://advancedktu-ai.onrender.com

# ============================================================================
# SHARED VARIABLES (Tüm Services)
# ============================================================================

# MongoDB Atlas Connection String
# Format: mongodb+srv://username:password@cluster-xxx.mongodb.net/
# Bunu al: https://www.mongodb.com/cloud/atlas → Cluster → Connect → Application
MONGO_URI=mongodb+srv://admin:YourPasswordHere@cluster-xxxxx.mongodb.net/?retryWrites=true&w=majority

# Google API Keys
# Generative Language API (Gemini)
# Bunu al: https://console.cloud.google.com → APIs & Services → Credentials
GOOGLE_GENERATIVE_AI_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Google Cloud Vision API (optional, if using image processing)
GOOGLE_VISION_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# JWT Secret (Render otomatik generate eder, veya manuel koyabilirsin)
JWT_SECRET=super-secret-key-that-is-at-least-32-chars-long-for-production!

# ============================================================================
# IMPORTANT NOTES
# ============================================================================

# 1. MONGO_URI:
#    - Test: mongodb://localhost:27017
#    - Production (Atlas): mongodb+srv://user:pass@cluster.mongodb.net/
#    - Bunu MongoDB Atlas'dan copy-paste yap
#
# 2. JWT_SECRET:
#    - Render auto-generate edebilir (render.yaml'da generateValue: true)
#    - Veya manually: 32+ char random string
#    - Production'da: openssl rand -base64 32
#
# 3. GOOGLE_GENERATIVE_AI_API_KEY:
#    - https://console.cloud.google.com adresinden al
#    - Free tier: 60 requests per minute
#    - Billing eklemeden çalışıyor
#
# 4. Service URLs:
#    - Auto-generated by Render based on service name
#    - Format: https://<service-name>.onrender.com
#    - render.yaml'daki 'fromService' otomatik handle eder
#
# 5. CORS:
#    - Frontend: https://advancedktu-frontend.onrender.com
#    - Go services'te CORS allow et
#
# 6. Sensitive Data:
#    - Never commit keys to GitHub!
#    - Render Dashboard'da gir (encrypted)
#    - Local testing: .env file kullan (gitignore'da)
#
# 7. Database:
#    - Render hosted DB sunmuyor (free plan)
#    - MongoDB Atlas free tier kullan: https://www.mongodb.com/cloud/atlas
#    - Başka seçenek: AWS RDS, Google Cloud SQL, etc.
#
# 8. Build Context:
#    - Render.yaml dockerfilePath: ./Dockerfile (root'dan)
#    - dockerBuildContext: . (root)
#    - go.mod paths: authentication-service/go.mod (COPY ile)

# ============================================================================
# SETUP ADIMLARI
# ============================================================================

# 1. MongoDB Atlas Setup:
#    1. https://www.mongodb.com/cloud/atlas
#    2. Create Free Cluster (M0)
#    3. Create Database User
#    4. Add IP to whitelist (0.0.0.0/0)
#    5. Get connection string
#    6. Render Dashboard → MONGO_URI variable

# 2. Google Cloud Setup:
#    1. https://console.cloud.google.com
#    2. Create Project: "AdvancedKTU"
#    3. Enable Generative Language API
#    4. Create API Key
#    5. Render Dashboard → GOOGLE_GENERATIVE_AI_API_KEY variable

# 3. Render Blueprint Setup:
#    1. https://render.com → Blueprints
#    2. New Blueprint Instance
#    3. GitHub repo select
#    4. render.yaml otomatik detect edilir
#    5. Services deploy olunca: Environment variables gir
#    6. Redeploy

# ============================================================================
# TESTING
# ============================================================================

# Test komutları (deploy sonrası):

# 1. Health Check
curl https://advancedktu-auth.onrender.com/swagger/

# 2. Register
curl -X POST https://advancedktu-auth.onrender.com/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'

# 3. Login
curl -X POST https://advancedktu-auth.onrender.com/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'

# 4. Check MongoDB
mongosh "mongodb+srv://username:password@cluster.mongodb.net/"

# 5. Check Logs
# Render Dashboard → Service → Logs sekmesi

# ============================================================================
# TROUBLESHOOTING
# ============================================================================

# Problem: "connection refused" (Database)
# Fix: 
#   1. MongoDB Atlas → Network Access → Allow All (0.0.0.0/0)
#   2. MONGO_URI format check
#   3. Database user credentials check

# Problem: "CORS error"
# Fix:
#   1. Go service'te CORS enable et
#   2. Frontend URL'i whitelist'e ekle
#   3. Redeploy

# Problem: "API key invalid"
# Fix:
#   1. Google Cloud Console'dan key check et
#   2. API enabled mi kontrol et
#   3. Render Dashboard'da key update et

# Problem: "Build timeout"
# Fix:
#   1. render.yaml build timeout increase:
#      build:
#        timeout: 1800  (30 minutes)
#   2. Dependencies optimize et
#   3. .dockerignore'ya unnecessary files ekle

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================

- [ ] MONGO_URI set (MongoDB Atlas)
- [ ] JWT_SECRET set (strong, 32+ chars)
- [ ] GOOGLE_GENERATIVE_AI_API_KEY set
- [ ] Service URLs correct (render.yaml)
- [ ] CORS configured
- [ ] Environment: production
- [ ] Database backups configured
- [ ] Monitoring active
- [ ] Error logging configured
- [ ] Rate limiting configured (API services)
- [ ] HTTPS enforced
- [ ] Security headers set

# ============================================================================
